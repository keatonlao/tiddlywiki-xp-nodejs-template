[{"title":"$:/plugins/tobibeer/inc","description":"Enhance transclusion by including tiddlers with an on-hover toolbar","author":"Tobias Beer","version":"0.5.2.1","core-version":">=5.1.9","source":"https://github.com/tobibeer/tw5-inc","documentation":"https://tobibeer.github.io/tw5-inc","plugin-type":"plugin","requires":"","list":"readme","modifier":"kl","dependents":"","type":"application/json","text":"{\"tiddlers\":{\"$:/plugins/tobibeer/inc/buttons/open\":{\"title\":\"$:/plugins/tobibeer/inc/buttons/open\",\"text\":\"<$button tooltip=\\\"Open this tiddler\\\" class=<<tv-config-toolbar-class>>>\\n<$action-navigate/>\\n<$list filter=\\\"[<tv-config-toolbar-icons>prefix[yes]]\\\">\\n{{$:/core/images/link}}\\n</$list>\\n<$list filter=\\\"[<tv-config-toolbar-text>prefix[yes]]\\\">\\n<span class=\\\"tc-btn-text\\\">open</span>\\n</$list>\\n</$button>\"},\"$:/plugins/tobibeer/inc/macro\":{\"title\":\"$:/plugins/tobibeer/inc/macro\",\"tags\":\"$:/tags/Macro\",\"text\":\"\\\\define incButtons()\\n\\\\whitespace trim\\n{{||$:/plugins/tobibeer/inc/buttons/open}}\\n{{||$:/core/ui/Buttons/edit}}\\n\\\\end\\n\\n\\\\define inc-transclusion(tiddler)\\n<$tiddler tiddler=\\\"\\\"\\\"$tiddler$\\\"\\\"\\\">\\n<div class=\\\"inc-transclusion\\\" title=\\\"{{$tiddler$}}\\\">\\n<div class=\\\"xp-inc\\\">\\n<span class=\\\"xp-inc-controls\\\">\\n<<incButtons>>\\n</span>\\n</div>\\n<div class=\\\"xp-inc-tiddler\\\">\\n<$transclude mode=block/>\\n</div>\\n</div>\\n</$tiddler>\\n\\\\end\\n\\n\\\\define tb-inc(tiddler)\\n<div class=\\\"tb-inc\\\" title=\\\"{{$tiddler$}}\\\">\\n<$tiddler tiddler=\\\"\\\"\\\"$tiddler$\\\"\\\"\\\">\\n<div class=\\\"tc-tiddler-controls tb-inc-controls\\\">\\n<<incButtons>>\\n</div>\\n<div class=\\\"tb-inc-tiddler\\\">\\n<$transclude mode=block/>\\n</div>\\n</$tiddler>\\n</div>\\n\\\\end\\n\\n\\\\define {(tiddler)\\n<$reveal default=\\\"\\\" type=\\\"match\\\" text=\\\"\\\"\\\"$tiddler$\\\"\\\"\\\">\\n<$macrocall $name=\\\"inc-transclusion\\\" tiddler=<<currentTiddler>>/>\\n</$reveal>\\n<$reveal default=\\\"\\\" type=\\\"nomatch\\\" text=\\\"\\\"\\\"$tiddler$\\\"\\\"\\\">\\n<$macrocall $name=\\\"inc-transclusion\\\" tiddler=\\\"\\\"\\\"$tiddler$\\\"\\\"\\\"/>\\n</$reveal>\\n\\\\end\\n\\n\\\\define {{(tiddler)\\n<$reveal default=\\\"\\\" type=\\\"match\\\" text=\\\"\\\"\\\"$tiddler$\\\"\\\"\\\">\\n<$macrocall $name=\\\"tb-inc\\\" tiddler=<<currentTiddler>>/>\\n</$reveal>\\n<$reveal default=\\\"\\\" type=\\\"nomatch\\\" text=\\\"\\\"\\\"$tiddler$\\\"\\\"\\\">\\n<$macrocall $name=\\\"tb-inc\\\" tiddler=\\\"\\\"\\\"$tiddler$\\\"\\\"\\\"/>\\n</$reveal>\\n\\\\end\"},\"$:/plugins/tobibeer/inc/readme\":{\"title\":\"$:/plugins/tobibeer/inc/readme\",\"text\":\"Provides the macro `<<{>>` that allows to transclude tiddlers with an on-hover toolbar for editing.\\n\\n: <$checkbox tiddler=\\\"$:/config/inc-transclusion/ShowControls\\\" field=\\\"text\\\" checked=\\\"hover\\\" unchecked=\\\"\\\" default=\\\"\\\"> Show controls on hover?</$checkbox>\\n\\n; documentation / examples / demos...\\n: http://tobibeer.github.io/tw5-plugins#inc\"},\"$:/plugins/tobibeer/inc/styles\":{\"title\":\"$:/plugins/tobibeer/inc/styles\",\"tags\":\"$:/tags/Stylesheet\",\"text\":\"\\\\define sidebarbreakpoint-minus-one()\\n<$text text={{{ [{$:/themes/tiddlywiki/vanilla/metrics/sidebarbreakpoint}removesuffix[px]subtract[1]addsuffix[px]] ~[{$:/themes/tiddlywiki/vanilla/metrics/sidebarbreakpoint}] }}}/>\\n\\\\end\\n\\n.tb-inc-controls{\\nmargin-top:-2em;\\npadding: 12px;\\ndisplay:none;\\n}\\n.tb-inc-tab-content .tb-inc{\\nmargin:0;\\npadding:0;\\nposition:relative;\\n}\\n.tb-inc-tab-content .tb-inc-controls{\\nposition:absolute;\\nmargin-top:-5px;\\nright:0;\\ntop:0;\\n}\\n.tb-inc:hover > .tb-inc-controls{\\ndisplay:block;\\nfloat:right;\\nposition: absolute;\\nright: calc(42px - 12px);\\n}\\n\\n.xp-inc {\\n  display: inline-block;\\n  position: absolute;\\n  right: 11px;\\n  width: 22px;\\n  padding: 5px 5px 42px 5px;\\n  box-sizing: content-box;\\n  background: none;\\n  overflow: hidden;\\n  margin-top: -1em;\\n}\\n\\n<$reveal state=\\\"$:/config/inc-transclusion/ShowControls\\\" type=\\\"match\\\" text=\\\"hover\\\">\\n\\n.inc-transclusion {\\n  border-radius: .5em;\\n  transition: 0.25s all ease;\\n}\\n\\n.inc-transclusion:hover > .xp-inc-tiddler::first-line {\\n  text-decoration: underline wavy;\\n  text-decoration-thickness: 1px;\\n}\\n\\n.xp-inc {\\n  visibility: hidden;\\n  opacity: 0;\\n  transition: opacity 0.3s;\\n}\\n\\n.inc-transclusion:hover > .xp-inc {\\n  visibility: visible;\\n  opacity: 1;\\n  transition: 0.25s all ease;\\n}\\n\\n</$reveal>\\n\\n.xp-inc-controls {\\n  display: flex;\\n  flex-wrap: wrap;\\n  flex: 1 0 100%;\\n  justify-content: center;\\n  align-items: center;\\n  padding: 12px 5px;\\n  border: 1px solid <<colour code-border>>;\\n  border-radius: 16px;\\n  background-color: <<colour code-background>>;\\n}\\n\\n<$reveal state=\\\"$:/config/_sq/Stories/story2\\\" type=\\\"match\\\" text=\\\"yes\\\" default=\\\"no\\\">\\n<$reveal stateTitle=\\\"$:/_sq/Stories/Story2StoryList\\\" stateField=\\\"list\\\" type=\\\"nomatch\\\" text=\\\"\\\">\\n\\n.tb-inc:hover > .tb-inc-controls{\\nright: calc(14px - 12px);\\n}\\n\\n.xp-inc {\\n  right: 0;\\n  padding: 5px 0 42px 5px;\\n}\\n\\n</$reveal></$reveal>\\n\\n@media (max-width: <<sidebarbreakpoint-minus-one>>) {\\n\\n.tb-inc:hover > .tb-inc-controls{\\nright: calc(14px - 12px - 10px);\\n}\\n\\n.xp-inc {\\n  right: 0;\\n  padding: 5px 0 42px 5px;\\n}\\n\\n}\\n\\n\\n<!-- \\n\\n.tb-inc:hover{\\nbackground-color:<<colour code-background>>;\\n}\\n\\n.inc-transclusion:hover {\\n  -webkit-box-shadow: 0 .5px <<colour foreground>>;\\n    -moz-box-shadow: 0 .5px <<colour foreground>>;\\n          box-shadow: 0 .5px <<colour foreground>>;\\n        /*box-shadow: 0 .5px #00ff00;*/\\n}\\n\\n-->\"},\"$:/plugins/tobibeer/inc/templates/tabs\":{\"title\":\"$:/plugins/tobibeer/inc/templates/tabs\",\"text\":\"<div class=\\\"tb-inc-tab-content\\\">\\n<$macrocall $name=\\\"{\\\" tiddler=<<currentTab>>/>\\n</div>\"},\"$:/plugins/tobibeer/inc/toolbar\":{\"title\":\"$:/plugins/tobibeer/inc/toolbar\",\"text\":\"$:/plugins/tobibeer/inc/buttons/open\\n\\n$:/core/ui/Buttons/edit\\n\\n$:/core/ui/Buttons/delete\"},\"$:/config/ShortcutInfo/inc\":{\"title\":\"$:/config/ShortcutInfo/inc\",\"text\":\"{{$:/language/Buttons/Inc/Hint}}\"},\"$:/config/inc-transclusion/ShowControls\":{\"title\":\"$:/config/inc-transclusion/ShowControls\",\"text\":\"hover\"},\"$:/xp/images/inc\":{\"title\":\"$:/xp/images/inc\",\"tags\":\"$:/tags/Image\",\"text\":\"<svg width=\\\"22pt\\\" height=\\\"22pt\\\" class=\\\"xp-image-inc tc-image-button\\\" viewBox=\\\"0 0 128 128\\\"><path d=\\\"m 50.1175,60.096997 c 0.591,0 1.36,-0.089 2.306,-0.265999 a 10.417,10.417 0 0 0 2.75,-0.932001 6.7619999,6.7619999 0 0 0 2.306,-1.907 c 0.649998,-0.828 0.975998,-1.863 0.975998,-3.104 v -17.564 c 0,-2.01 0.414,-3.74 1.242,-5.19 0.828,-1.448 1.833,-2.66 3.016,-3.636 1.183,-0.976 2.425,-1.7 3.726,-2.173 1.3,-0.473 2.424,-0.71 3.37,-0.71 h 8.073 v 7.451 h -4.88 c -1.241,0 -2.232,0.207002 -2.97,0.621 -0.74,0.414 -1.302,0.932 -1.686,1.552 a 4.909,4.909 0 0 0 -0.71,1.996 c -0.09,0.71 -0.133,1.39 -0.133,2.04 v 16.677 c 0,1.715 -0.325,3.134 -0.976,4.258 -0.65,1.123 -1.434,2.025 -2.35,2.705 -0.917,0.68 -1.863,1.168 -2.839,1.464 -0.976,0.296 -1.818,0.473 -2.528,0.532 v 0.178001 c 0.71,0.059 1.552,0.206999 2.528,0.442999 0.976,0.237 1.922,0.68 2.839,1.33 0.916,0.651 1.7,1.583 2.35,2.794998 0.65,1.212 0.976,2.853002 0.976,4.923002 V 89.72399 c 0,0.65 0.04,1.33 0.133,2.04 0.09,0.71 0.325,1.375 0.71,1.996 0.384,0.621 0.946,1.139 1.685,1.553 0.74,0.41402 1.73,0.62 2.972,0.62 h 4.879 v 7.45201 h -8.073 c -0.946,0 -2.07,-0.23699 -3.37,-0.71 -1.301,-0.473 -2.543,-1.197 -3.726,-2.173 -1.183,-0.97601 -2.188,-2.18801 -3.016,-3.63701 -0.828,-1.449 -1.242,-3.179 -1.242,-5.19 V 74.733995 c 0,-1.419997 -0.325,-2.571997 -0.975998,-3.459997 -0.65,-0.886001 -1.419,-1.581002 -2.306,-2.084003 a 8.8679998,8.8679998 0 0 0 -2.75,-1.019998 c -0.946,-0.177 -1.715,-0.266 -2.306,-0.266 v -7.806 z M 128,61.296 c -0.139,2.286 -2.512,3.396 -3.791,5.026 -6.239,6.194 -12.392,12.482 -18.684,18.616 -2.33,1.747 -5.599,-1.539 -4.259,-3.948 1.51,-1.826 3.327,-3.4 4.969,-5.118 l 14.576,-14.575 c -6.403,-6.41 -12.819,-12.807 -19.214,-19.223 -1.68,-1.708 -0.056,-4.552 2.083,-4.797 1.921,-0.352 2.955,1.613 4.21,2.677 6.51,6.54 13.087,13.017 19.549,19.6 0.363,0.503 0.564,1.121 0.561,1.742 z m -14.527,0 c -0.102,2.123 -2.214,3.202 -3.446,4.681 -6.253,6.247 -12.494,12.506 -18.754,18.745 -1.708,1.68 -4.552,0.056 -4.797,-2.083 -0.338,-1.872 1.52,-2.888 2.574,-4.109 L 106.283,61.297 C 99.88,54.887 93.465,48.49 87.07,42.074 c -1.679,-1.708 -0.055,-4.552 2.084,-4.797 1.921,-0.352 2.955,1.613 4.21,2.677 6.51,6.54 13.087,13.018 19.549,19.6 0.362,0.503 0.563,1.121 0.561,1.742 z M 14.527,61.39 c 0.102,-2.123 2.214,-3.202 3.446,-4.68 6.253,-6.248 12.494,-12.507 18.754,-18.746 1.708,-1.68 4.552,-0.056 4.797,2.083 0.338,1.872 -1.519,2.888 -2.573,4.108 L 21.717,61.389 c 6.43,6.448 12.897,12.864 19.306,19.332 1.647,2.072 -0.8,5.596 -3.322,4.562 -1.776,-0.789 -2.855,-2.517 -4.285,-3.77 -6.021,-6.042 -12.086,-12.046 -18.079,-18.11 -0.515,-0.6 -0.718,-1.236 -0.81,-2.012 z M 0,61.301 c 0.14,-2.29 2.519,-3.402 3.802,-5.035 6.249,-6.186 12.373,-12.512 18.707,-18.603 2.316,-1.533 5.628,1.358 4.204,3.835 -1.065,1.644 -2.68,2.842 -4.001,4.28 L 7.189,61.3 c 6.383,6.397 12.795,12.765 19.159,19.18 1.952,2.077 -0.63,5.857 -3.279,4.68 C 21.067,84.11 19.805,82.08 18.101,80.633 12.25,74.743 6.308,68.932 0.52,62.983 A 2.977,2.977 0 0 1 0,61.302 Z\\\"/></svg>\"},\"$:/language/Buttons/Inc/Caption\":{\"title\":\"$:/language/Buttons/Inc/Caption\",\"text\":\"inc\"},\"$:/language/Buttons/Inc/Hint\":{\"title\":\"$:/language/Buttons/Inc/Hint\",\"text\":\"Create inc transclusion\"},\"$:/language/Snippets/inc/prefix\":{\"title\":\"$:/language/Snippets/inc/prefix\",\"text\":\"<<{ [[\"},\"$:/language/Snippets/inc/suffix\":{\"title\":\"$:/language/Snippets/inc/suffix\",\"text\":\"]]>>\"},\"$:/language/Snippets/inc\":{\"title\":\"$:/language/Snippets/inc\",\"caption\":\"inc transclusion\",\"tags\":\"$:/tags/TextEditor/Snippet\"},\"$:/xp/custom-plugins/tobibeer/inc/readme\":{\"title\":\"$:/xp/custom-plugins/tobibeer/inc/readme\",\"created\":\"20220731093523023\",\"modified\":\"20220731113107169\",\"text\":\"!! 修改文件\\n\\n* $:/plugins/tobibeer/inc/macro\\n* $:/plugins/tobibeer/inc/buttons/open\\n* $:/plugins/tobibeer/inc/styles\\n** $:/config/inc-transclusion/ShowControls\\n* $:/plugins/tobibeer/inc/readme\\n\\n!! 新增文件\\n\\n编辑器工具栏按钮：\\n\\n* $:/xp/ui/EditorToolbar/inc\\n* $:/xp/ui/EditorToolbar/inc-dropdown\\n* $:/xp/images/inc\\n* $:/language/Buttons/Inc/Caption\\n* $:/language/Buttons/Inc/Hint\\n* $:/config/shortcuts/inc\\n* $:/config/ShortcutInfo/inc\\n\\n图章：\\n\\n* $:/language/Snippets/inc\\n* $:/language/Snippets/inc/prefix\\n* $:/language/Snippets/inc/suffix\\n\"},\"$:/config/shortcuts/inc\":{\"title\":\"$:/config/shortcuts/inc\",\"text\":\"\"},\"$:/xp/ui/EditorToolbar/inc-dropdown\":{\"title\":\"$:/xp/ui/EditorToolbar/inc-dropdown\",\"text\":\"\\\\define lingo-base() $:/language/Buttons/Inc/\\n\\n\\\\define pt() <<{ [[\\n\\\\define st() ]]>>\\n\\n\\\\define add-inc-actions()\\n<$action-sendmessage $message=\\\"tm-edit-text-operation\\\" $param=\\\"insert-text\\\" text={{{ [[$(incTiddler)$]get[text]addprefix<pt>addsuffix<st>] }}} />\\n<$action-deletetiddler $filter=\\\"[<dropdown-state>] [<searchTiddler>] [<incTiddler>] [<storeTitle>] [<searchListState>]\\\"/>\\n\\\\end\\n\\n\\\\define get-focus-selector() [data-tiddler-title=\\\"$(cssEscapedTitle)$\\\"] .tc-create-wikitext-link input\\n\\n\\\\define cancel-search-actions-inner()\\n<$set name=\\\"userInput\\\" value={{{ [<storeTitle>get[text]] }}}><$list filter=\\\"[<searchTiddler>get[text]!match<userInput>]\\\" emptyMessage=\\\"\\\"\\\"<$action-deletetiddler $filter=\\\"[<searchTiddler>] [<incTiddler>] [<storeTitle>] [<searchListState>]\\\"/>\\\"\\\"\\\"><$action-setfield $tiddler=<<searchTiddler>> text=<<userInput>>/><$action-setfield $tiddler=<<refreshTitle>> text=\\\"yes\\\"/></$list></$set>\\n\\\\end\\n\\n\\\\define cancel-search-actions() <$list filter=\\\"[<storeTitle>!has[text]] +[<searchTiddler>!has[text]]\\\" emptyMessage=\\\"\\\"\\\"<<cancel-search-actions-inner>>\\\"\\\"\\\"><$action-sendmessage $message=\\\"tm-edit-text-operation\\\" $param=\\\"focus-editor\\\"/></$list>\\n\\n\\\\define external-link()\\n<$button class=\\\"tc-btn-invisible\\\" style=\\\"width: auto; display: inline-block; background-colour: inherit;\\\" actions=<<add-inc-actions>>>\\n{{$:/core/images/chevron-right}}\\n</$button>\\n\\\\end\\n\\n\\\\define set-next-input-tab(beforeafter:\\\"after\\\") <$macrocall $name=\\\"change-input-tab\\\" stateTitle=\\\"$:/state/tab/search-results/sidebar\\\" tag=\\\"$:/tags/SearchResults\\\" beforeafter=\\\"$beforeafter$\\\" defaultState={{$:/config/SearchResults/Default}} actions=\\\"\\\"\\\"<$action-setfield $tiddler=\\\"$:/state/search/currentTab\\\" text=<<nextTab>>/>\\\"\\\"\\\"/>\\n\\n\\\\define body(config-title)\\n''<<lingo Hint>>''\\n\\n<$vars searchTiddler=\\\"\\\"\\\"$config-title$/search\\\"\\\"\\\" incTiddler=\\\"\\\"\\\"$config-title$/inc\\\"\\\"\\\" linktext=\\\"\\\" searchListState=<<qualify \\\"$:/temp/link-search/selected-item\\\">> refreshTitle=<<qualify \\\"$:/temp/link-search/refresh\\\">> storeTitle=<<qualify \\\"$:/temp/link-search/input\\\">>>\\n\\n<$vars incTiddler=<<searchTiddler>>>\\n<$keyboard key=\\\"((input-tab-right))\\\" actions=<<set-next-input-tab>>>\\n<$keyboard key=\\\"((input-tab-left))\\\" actions=<<set-next-input-tab \\\"before\\\">> class=\\\"tc-create-wikitext-link\\\">\\n<$macrocall $name=\\\"keyboard-driven-input\\\" tiddler=<<searchTiddler>> storeTitle=<<storeTitle>>\\n\\t\\tselectionStateTitle=<<searchListState>> refreshTitle=<<refreshTitle>> type=\\\"search\\\" filterMinLength=\\\"1\\\"\\n\\t\\ttag=\\\"input\\\" focus=\\\"true\\\" class=\\\"tc-popup-handle\\\" inputCancelActions=<<cancel-search-actions>> \\n\\t\\tinputAcceptActions=<<add-inc-actions>> placeholder={{$:/language/Search/Search}} default=\\\"\\\" \\n\\t\\tconfigTiddlerFilter=\\\"[[$:/state/search/currentTab]!is[missing]get[text]] ~[{$:/config/SearchResults/Default}]\\\" />\\n</$keyboard>\\n</$keyboard>\\n<$reveal tag=\\\"span\\\" state=<<storeTitle>> type=\\\"nomatch\\\" text=\\\"\\\">\\n<<external-link>>\\n<$button class=\\\"tc-btn-invisible\\\" style=\\\"width: auto; display: inline-block; background-colour: inherit;\\\">\\n<<cancel-search-actions>><$set name=\\\"cssEscapedTitle\\\" value={{{ [<storyTiddler>escapecss[]] }}}><$action-sendmessage $message=\\\"tm-focus-selector\\\" $param=<<get-focus-selector>>/></$set>\\n{{$:/core/images/close-button}}\\n</$button>\\n</$reveal>\\n</$vars>\\n\\n<$reveal tag=\\\"div\\\" state=<<storeTitle>> type=\\\"nomatch\\\" text=\\\"\\\">\\n\\n<$linkcatcher actions=<<add-inc-actions>> to=<<incTiddler>>>\\n\\n<$vars userInput={{{ [<storeTitle>get[text]] }}} configTiddler={{{ [[$:/state/search/currentTab]!is[missing]get[text]] ~[{$:/config/SearchResults/Default}] }}}>\\n\\n{{$:/core/ui/SearchResults}}\\n\\n</$vars>\\n\\n</$linkcatcher>\\n\\n</$reveal>\\n\\n</$vars>\\n\\n\\\\end\\n\\n<$macrocall $name=\\\"body\\\" config-title=<<qualify \\\"$:/state/Inc/\\\">>/>\\n\"},\"$:/xp/ui/EditorToolbar/inc\":{\"title\":\"$:/xp/ui/EditorToolbar/inc\",\"caption\":\"{{$:/language/Buttons/Inc/Caption}}\",\"condition\":\"[<targetTiddler>type[]] [<targetTiddler>type[text/vnd.tiddlywiki]] +[first[]]\",\"description\":\"{{$:/language/Buttons/Inc/Hint}}\",\"dropdown\":\"$:/xp/ui/EditorToolbar/inc-dropdown\",\"icon\":\"$:/xp/images/inc\",\"list-after\":\"$:/core/ui/EditorToolbar/transcludify\",\"shortcuts\":\"((inc))\",\"tags\":\"$:/tags/EditorToolbar\"}}}","revision":"0","bag":"default"}]